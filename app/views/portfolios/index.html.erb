<div class="w-full px-8">
<h1 class="mb-4 text-4xl font-extrabold leading-none tracking-tight text-gray-900 md:text-3xl lg:text-4xl dark:text-white">Portfolio Overview</h1>
<p class="mb-6 text-lg font-normal text-gray-500 lg:text-xl sm:px-8 xl:px-24 dark:text-gray-400">Total Portfolio Value: <%= number_to_currency(@total_portfolio_value) %></p>
<p class="mb-6 text-lg font-normal text-gray-500 lg:text-xl sm:px-8 xl:px-24 dark:text-gray-400">Wallet: <%= number_to_currency(@cash_balance) %></p>

<div id="portfolio-chart">
  <%= render 'portfolio_chart' %>
</div>

<div class="py-4 border-t border-gray-200 dark:border-gray-600 max-h-[500px] overflow-y-auto">
  <% if @portfolios.empty? %>
    <p class="text-gray-500 dark:text-gray-400">
      You currently do not have any stocks in your portfolio. To begin investing, <%= link_to "purchase stocks", stocks_path %> now.
    </p>
  <% else %>
<ul class="bg-lightdark p-4 list-none grid grid-cols-1 gap-4 lg:grid-cols-3 sm:grid-cols-2">
  <% @portfolios.each do |portfolio| %>
  <% portfolio.stocks.each do |stock| %>
  <li>
    <%= link_to portfolio_path(portfolio) do %>
      <div class="leading-1.5 p-4 bg-black">
      <div class="flex flex-col">
        <div class="mb-2 text-3xl font-extrabold text-white">
        <%= stock.ticker_symbol %>
        </div>
      <% if @quotes[stock.ticker_symbol].present? %>
        <% change = @quotes[stock.ticker_symbol].change %>
        <div class="text-gray-500 dark:text-gray-400 flex items-center">
        <% if change.present? %>
          <% if change.positive? %>
            <i class="material-icons text-500 mr-1" style="color: green; text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);">arrow_drop_up</i>
            <p class="text-green-500" style= "text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);"><%= @quotes[stock.ticker_symbol].latest_price %></p>
          <% elsif change.negative? %>
            <i class="material-icons text-500 mr-1" style="color: red; text-shadow: 0 0 5px rgba(255, 0, 0, 0.5);">arrow_drop_down</i>
            <p class="text-red-500" style= "text-shadow: 0 0 5px rgba(255, 0, 0, 0.5);"><%= @quotes[stock.ticker_symbol].latest_price %></p>
          <% end %>
        <% else %>
          <p class="text-gray-500 dark:text-gray-400"><%= @quotes[stock.ticker_symbol].latest_price %></p>
        <% end %>
        </div>
      <div class="text-gray-500 dark:text-gray-400"><%= @quotes[stock.ticker_symbol].change_percent_s %></div>
      <div class="text-gray-500 dark:text-gray-400"><%= @quotes[stock.ticker_symbol].change %></div>
      <% end %>
      </div>         
      </div>
    <% end %>
  </li>
  <% end %>
  <% end %>
</ul>
<% end %>
</div>